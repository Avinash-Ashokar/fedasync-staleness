# ---- Data ----
data:
  dataset: cifar10
  data_dir: ./data
  num_classes: 10
  alpha_list: [0.1, 1.0, 10.0, 100.0, 1000.0]

# ---- Clients ----
clients:
  total: 20
  concurrent: 8
  local_epochs: 1
  batch_size: 128
  lr: 0.0125
  momentum: 0.9
  weight_decay: 5e-4

  # --- heterogeneity controls ---
  struggle_percent: 30          # % of all clients that are slow
  delay_slow_range: [0.8, 2.0]  # seconds, Uniform[a, b] for slow clients
  delay_fast_range: [0.0, 0.2]  # seconds, Uniform[a, b] for fast/normal clients
  jitter_per_round: 0.1         # extra +/- seconds each local fit; 0 disables
  fix_delays_per_client: true   # true: sample once per client; false: resample every fit
  straggler_fraction: 0.0       # probability of straggler delay per dispatch (SB1)
  straggler_scale: 3.0         # scale factor for straggler delays (SB1)

# ---- Buffered FedBuff ----
buff:
  buffer_size: 8
  buffer_timeout_s: 0.5
  use_sample_weighing: true
  staleness_type: poly  # poly or exp
  staleness_alpha: 0.5
  clip_norm: null  # float or null
  tau_max: null  # int or null
  eta: 0.00125  # server learning rate

# ---- Evaluation / stopping ----
eval:
  interval_seconds: 0.5      # evaluate/log every T seconds (timeout)
  target_accuracy: 0.8     # stop when global test_acc >= this value

# ---- Safety cap on merges (optional) ----
train:
  max_rounds: 300  # min(300 flushes, 30 minutes)

# ---- Partitioning ----
partition_alpha: 0.5

# ---- Reproducibility ----
seed: 1

# ---- Runtime / I/O ----
server_runtime:
  client_delay: 0.0   # extra global delay added on every client before training

io:
  checkpoints_dir: ./checkpoints/FedBuff
  logs_dir: ./logs
  results_dir: ./results

  # configurable file paths
  global_log_csv: ./logs/FedBuff.csv
  client_participation_csv: ./logs/FedBuffClientParticipation.csv
  final_model_path: ./results/FedBuffModel.pt
